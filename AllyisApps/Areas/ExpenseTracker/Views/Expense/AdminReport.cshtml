@using AllyisApps.ViewModels.ExpenseTracker.Expense;
@using AllyisApps.Services.Expense;

@model AdminReportModel

@{
	Layout = "~/Areas/ExpenseTracker/Views/Shared/_Layout.cshtml";
	ViewBag.Title = "Admin Report";
}
@Scripts.Render("~/bundles/jquery")

<div class="row">
	@using (Html.BeginForm(ActionConstants.ViewAdminReport, ControllerConstants.Expense, FormMethod.Post))
	{
		@Html.Hidden("organizationId", Model.OrganizationId)
		@Html.Hidden("subscriptionId", Model.SubscriptionId)

		<div class="col-sm-12 col-md-12 col-lg-12">
			<div class="list-left col-sm-2 col-md-2 col-lg-2">
				<label for="Users">@Strings.Employees</label><br />
				@Html.ListBoxFor(m => m.Selection.SelectedUsers,
								Model.Users,
								htmlAttributes: new { @class = "form-control col-md-3 col-lg-3", multiple = "multiple", size = "5", @style = "width: 100%; margin-bottom: 15px;" })
			</div>

			<div class="options-right col-sm-2 col-md-2 col-lg-2">
				<label for="Statuses">Status</label>
				@Html.ListBoxFor(m => m.Selection.Status,
								Model.Statuses,
								htmlAttributes: new { @class = "form-control col-md-3 col-lg-3", size = "5", @style = "width:85%" })
			</div>
			<div class="options-right container col-sm-8 col-md-8 col-lg-8">
				<div class="row">
					<div class="form-group col-md-4 col-lg-4 col-sm-4 form-inline">
						<label style="margin-right:200px">@Strings.StartDate</label><br />
						@Html.TextBoxFor(m => m.Selection.StartDate, "{0:MM-dd-yyyy}", new { @class = "datepicker form-control item-control", Name = "startDate", style = "display: inline-block; width: 150px" })
						<span class="fa fa-fw fa-calendar fa-lg" style="margin-top:10px;" id="datePickerStartButton" title="Choose start date"></span>
					</div>
					<div class="form-group col-md-4 col-lg-4 col-sm-4 form-inline">
						<label style="margin-right:200px">@Strings.EndDate</label><br />
						@Html.TextBoxFor(m => m.Selection.EndDate, "{0:MM-dd-yyyy}", new { @class = "datepicker form-control item-control", Name = "endDate", style = "display: inline-block; width: 150px" })
						<span class="fa fa-fw fa-calendar fa-lg" style="margin-top:10px;" id="datePickerEndButton" title="Choose end date"></span>
					</div>
				</div>
				<div class="col-sm-7 col-md-7 col-lg-7" style="margin: 0 0 15px 15px;">
					<div>
						<input class="btn btn-primary pull-right" type="submit" name="viewDataButton" value=@Strings.Export title="Export Excel Time Tracker entries" />
					</div>
					<div>
						<input class="btn btn-primary pull-right" type="submit" name="viewDataButton" style="margin-left: 15px;" value=@Strings.Preview title="Preview Excel Time Tracker entries" />
					</div>
				</div>
			</div>
		</div>
	}
</div>

<div class="col-xs-12">

	@if (Model.PreviewReports != null && Model.PreviewReports.Any())
	{
		<div class="panel panel-default">
			<table class="table table-hover table-condensed">
				<thead class="panel-heading">
					<tr class="double-bottom-border">
						<th>Report Name</th>
						<th>User</th>
						<th>Status</th>
						<th>Created</th>
						<th>Modified</th>
					</tr>
				</thead>
				<tbody>
					@foreach (ExpenseReportViewModel rp in Model.PreviewReports)
					{
						<tr class="previewRow">
							<td>@rp.ReportTitle</td>
							<td>@rp.SubmittedById</td>
							<td>@((ExpenseStatusEnum)rp.ReportStatus)</td>
							<td>@rp.CreatedUtc</td>
							<td>@rp.ModifiedUtc</td>
						</tr>
					}

					<tr id="tableEnd" class="nohover">
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>
				</tbody>
			</table>
		</div>
	}
	else
	{
		<div style="margin-top: 15px;">
			<p>
				No Data to Display...
			</p>
		</div>
	}
</div>

@section css
	{
	<link rel="stylesheet" type="text/css" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css" />
	<link rel="stylesheet" type="text/css" href="~/Content/jquery.comiseo.daterangepicker.css" />
}

@section scripts
	{

	@*Date range picker dependencies:*@
	@Scripts.Render("~/bundles/jqueryui")
	@Scripts.Render("~/bundles/moment")
	<script type="text/javascript">
		var model_startofweek = @Model.Selection.StartDate.Value;
		var model_startdate = @Model.Selection.StartDate.Value;
		var model_enddate = @Model.Selection.EndDate.Value;
	</script>
	@Scripts.Render("~/bundles/daterangepickerold")

	<script type="text/javascript">
		function setDatePickers() {
			console.log('setting date picker');
			$('.datepicker').each(function () {
				$(this).datepicker({
					changeMonth: true,
					changeYear: true
				});
			});
		}
		setDatePickers();
	</script>

}