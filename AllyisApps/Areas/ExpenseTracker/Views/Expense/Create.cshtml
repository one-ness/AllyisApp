@using AllyisApps.ViewModels.ExpenseTracker.Expense;
@using AllyisApps.Core;
@using AllyisApps.Services;

@model ExpenseIndexViewModel

@{
	ViewBag.Title = Strings.Report;
	Layout = "~/Areas/ExpenseTracker/Views/Shared/_Layout.cshtml";
	var items = new List<string>();
	items.AddRange(new string[]{""});
}

<div class="row report-wrap">

	<div class="panel panel-info" style="background-color: #f5f5f5; float: right; width: 300px;">
		<div class="panel-heading"><span class="panel-title">@Strings.Upload</span></div>
		@using (Html.BeginForm(ActionConstants.Import, ControllerConstants.Expense, new { subscriptionid = Model.SubscriptionId }, FormMethod.Post, new { enctype = "multipart/form-data" }))
			{
			@Html.AntiForgeryToken();
			<div>
				<input type="file" id="upload-box" name="upload" style="display:none;"
					   onchange="$('#upload-file-name-display').val($(this).val().replace('C:\\fakepath\\', ''));" />
				<input id="upload-file-name-display" class="form-control"
					   onchange="$('#upload-file-name-display').val($(this).val().replace('C:\\fakepath\\', ''));" />
			</div>
			@*<div style="width:70%; margin:0 auto">*@
			<div id="footUpload" style="background-color:#f5f5f5; display: flex; justify-content: space-around; flex-wrap: wrap; padding-bottom: 0px; float:right; margin-top: 10px;">
				<a onclick="$('input[id=upload-box]').click();" title="Choose Excel file containing Expense Tracker entries">
					<span class="btn btn-primary">@Strings.ChooseFile</span>
				</a>
				<input type="submit" style="margin-left: 3px; margin-right: 3px;" id="upload-button" value="@Strings.Upload" class="btn btn-primary" title="Upload Excel Expense Tracker entries" />
			</div>
			}
		@using (Html.BeginForm(ActionConstants.Template, ControllerConstants.Expense, null, FormMethod.Get, new { style = "margin-bottom:10px;" }))
			{
			<div style="margin-top: 10px; margin-left: 3px; margin-bottom:10px;">
				<input type="submit" id="template-button" value="@Strings.Template" class="btn btn-primary tt-template" title="Download Excel Expense Tracker template" />
			</div>
			}
	</div>
	<div class="col-md-12" style="float: left;">
		<div class="row">
			@using (Html.BeginForm(ActionConstants.ViewReport, ControllerConstants.Expense, FormMethod.Post, htmlAttributes: new { @id = "reportForm" }))
            {
                @Html.HiddenFor(m => m.SubscriptionId)
                <div class="options-right container">
                    <div class="row">

						<!-- A holder for all the projects, to draw from for populating the real selection list -->
						<select id="allprojects" style="display: none;">
							@if (Model.Reports != null)
							{
								foreach (ExpenseItemViewModel item in Model.Reports)
								{
									<option value="@item.ReportId" class="projectSelectOption">@item.ReportName</option>
								}
							}
						</select>
                    </div>
					<div class="form-group" style="width: 50%;">
						<div class="left-label">
							<label>Report Name</label>
						</div>
						<div class="right-input">
							<input type="text" name="ReportName" value="" class="form-control"/>
						</div>
						<div class="left-label">
							<label>Business Justification</label>
						</div>
						<div class="right-input">
							<input type="text" name="BusinessJustification" value="" class="form-control" />
						</div>
						<div class="left-label">
							<label>@Strings.Date</label>
						</div>
						<div class="right-input">
							<input name="date" type="text" class="datepicker form-control" id="DateRangeStart" style="display: inline-block; width: 75%" />
							@*<span class="fa fa-fw fa-calendar fa-lg" style="margin-top:10px;" id="datePickerStartButton" title="Choose start date"></span>*@
						</div>
						<input type="hidden" id="DateRangeStart" name="DateRangeStart" value="@Model.StartDate" />
					</div>
					<div class="panel panel-default">
						<div class="panel-heading">
							Items
						</div>
						<div>
							@for (int i = 0; i < items.Count; i++)
							{
								string dateName = String.Format("[{0}].TransactionDate", i);
								string nameName = String.Format("[{0}].ExpenseItemName", i);
								string amountName = String.Format("[{0}].Amount", i);
								string checkboxName = String.Format("[{0}].IsBillableToCustomer", i);
								<div class="item-div">
									<input type="text" value="" class="datepicker form-control" name="@dateName" style="display: inline-block; width: 150px" placeholder = "Date"/>
									@*<span class="fa fa-fw fa-calendar fa-lg" style="margin-top:10px;" id=@item title="Choose start date"></span>*@
									<input type="text" value="" class="form-control" name="@nameName" style="display: inline-block; width: 150px" placeholder="Name" />
									<input type="text" value="" class="form-control" name="@amountName" style="display: inline-block; width: 150px" placeholder="Amount" />
									<label>Payed for by Customer</label>
									<input type="checkbox" checked class="form-control" name="@checkboxName" />
									<a>
										<span class="btn btn-primary">
											Remove
										</span>
									</a>
								</div>
							}
						</div>
						<div style="text-align: center;">
							<a>
								<span class="btn btn-primary">
									Add Item
								</span>
							</a>
						</div>
					</div>

					<div class="row">
						<div class="col-xs-12">
							<div>
								<input class="btn btn-primary pull-left" type="submit" name="viewDataButton" value=@Strings.Export title="Export Excel Expense Tracker entries" />
							</div>
							<div>
								<input class="btn btn-primary pull-left" type="submit" name="viewDataButton" style="margin-left: 15px;" value=@Strings.Preview title="Preview Excel Expense Tracker entries"/>
							</div>
						</div>
					</div>
				</div>
			}
		</div>
		<br>
	</div>

	@*<div class="col-xs-12">
		<div class="panel panel-default">
			<div class="panel-body" style="padding: 0px">
			</div>
			<div id="data-message" class="panel-footer">
			</div>
		</div>
	</div>*@
</div>

@section css
{
	<link rel="stylesheet" type="text/css" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css" />
	<link rel="stylesheet" type="text/css" href="~/Content/jquery.comiseo.daterangepicker.css" />
}

@section scripts
{
	@*Date range picker dependencies:*@
	@Scripts.Render("~/bundles/jqueryui")
	@Scripts.Render("~/bundles/moment")

	<script src="~/Scripts/allyis-pages-with-filter.js" type="text/javascript"></script>
	@Scripts.Render("~/bundles/daterangepicker")
	<script type="text/javascript">
		pwf.setPageLimit(15);
		pwf.setPageButtonLimit(10);
		pwf.setRowClass("previewRow");
		$('.datepicker').each(function () {
			$(this).datepicker();
		});
	</script>
}
