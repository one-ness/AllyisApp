@using AllyisApps.ViewModels.TimeTracker.TimeEntry;
@using AllyisApps.Core;
@using AllyisApps.Services;
@using AllyisApps.Services.TimeTracker;
@model SettingsViewModel

@{
    ViewBag.Title = AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Settings;
    DisplayHints.BreadcrumbNavPartialLocation = "~/Areas/TimeTracker/Views/Shared/_BreadcrumbNavPartial.cshtml";
    DisplayHints.LayoutThemeBundle = "~/Content/Timetracker";
    Layout = "~/Views/Shared/_LayoutSidebar.cshtml";
}

@section css {
    <link rel="stylesheet" type="text/css" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css" />

}
<div class="flexbox-row flexbox-row-2-col-collapse">
        <div class="panel panel-info" style="position: relative;">
            <div class="panel-heading">
                <h1 class="panel-title">@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.OrgSOW</h1>
            </div>
            <div class="panel-body" id="SOWSetting">
                @using (Html.BeginForm(ActionConstants.UpdateStartOfWeek, ControllerConstants.TimeEntry, FormMethod.Post, new { enctype = "multipart/form-data" }))
                {
                    @Html.AntiForgeryToken();

                    <input type="radio" name="startOfWeek" style="margin:5px" id="sow" value="1" @(Model.Settings.StartOfWeek == (int)StartOfWeekEnum.Monday ? " checked " : string.Empty)><text>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Monday</text><br />
                    <input type="radio" name="startOfWeek" style="margin:5px" id="sow" value="2" @(Model.Settings.StartOfWeek == (int)StartOfWeekEnum.Tuesday ? " checked " : string.Empty)><text>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Tuesday</text><br />
                    <input type="radio" name="startOfWeek" style="margin:5px" id="sow" value="3" @(Model.Settings.StartOfWeek == (int)StartOfWeekEnum.Wednesday ? " checked " : string.Empty)><text>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Wednesday</text><br />
                    <input type="radio" name="startOfWeek" style="margin:5px" id="sow" value="4" @(Model.Settings.StartOfWeek == (int)StartOfWeekEnum.Thursday ? " checked " : string.Empty)><text>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Thursday</text><br />
                    <input type="radio" name="startOfWeek" style="margin:5px" id="sow" value="5" @(Model.Settings.StartOfWeek == (int)StartOfWeekEnum.Friday ? " checked " : string.Empty)><text>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Friday</text><br />
                    <input type="radio" name="startOfWeek" style="margin:5px" id="sow" value="6" @(Model.Settings.StartOfWeek == (int)StartOfWeekEnum.Saturday ? " checked " : string.Empty)><text>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Saturday</text><br />
                    <input type="radio" name="startOfWeek" style="margin:5px" id="sow" value="0" @(Model.Settings.StartOfWeek == (int)StartOfWeekEnum.Sunday ? " checked " : string.Empty)><text>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Sunday</text><br />

                    <br />
                    <input type="submit" value=@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Save class="btn btn-primary tt-bottom-right" />
                }
            </div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">
                <h1 class="panel-title">@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.PClasses</h1>
            </div>
            <div id="PayClasses">
                <table class="table table-condensed">
                    <thead>
                        <tr>
                            <th>Pay Class</th>
                            <th><span class="pull-right">Delete</span></th>
                        </tr>
                    </thead>
                    @foreach (PayClass PayClass in Model.PayClasses)
                    {
                        <tr>
                            <td>@(AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.ResourceManager.GetString((PayClass.Name).Replace(" ", string.Empty)) ?? PayClass.Name)</td>
                            <td>
								<a href="javascript: void(0);" class="text-muted" title="Delete Pay Class"
								   onclick='deletePayClass("@PayClass.PayClassID", "@PayClass.Name")'><span class="fa fa-fw fa-remove text-danger pull-right"></span></a>
                            </td>
                        </tr>
                    }
					<tr>
						@using (Html.BeginForm(ActionConstants.CreatePayClass, ControllerConstants.TimeEntry, FormMethod.Post))
						{
							@Html.AntiForgeryToken();
							<td><input type="text" name="NewPayClass" class="form-control" /></td>
							<td><input class="pull-right btn btn-primary" type="submit" value="@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Add" /></td>
						}
					</tr>
                </table>
            </div>
        </div>
        <div class="panel panel-info" style="position: relative; padding-bottom: 40px;" @*style="width: 400px; margin: 10px auto;"*@>
            <div class="panel-heading">
                <h1 class="panel-title">@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.LockDate</h1>
            </div>
            <div class="panel-body" id="LockDate">
                @using (Html.BeginForm(ActionConstants.SetLockDate, ControllerConstants.TimeEntry, FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                    @Html.AntiForgeryToken();
                    <div id="NoLockDate" style="margin: 10px">
                        <input type="radio" name="LDsetting" id="LDsetting" value="false" onclick="disableLD(true)" @(!Model.Settings.LockDateUsed ? " checked" : string.Empty) /><text> @AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.NoLockDate</text>
                    </div>
                    <div id="LockDate" style="margin: 10px">
                        <input type="radio" name="LDsetting" id="LDsetting" value="true" onclick="disableLD(false)" @(Model.Settings.LockDateUsed ? " checked" : string.Empty) /><text> @AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.UseLockDate</text>
                        <input type="text" id="LDquantity" name="LDquantity" value="@Model.Settings.LockDateQuantity" class="form-control" style="width: 40px; text-align: right; display: inline-block;" />
                        <select id="LDperiod" name="LDperiod" class="form-control" value='@(Model.Settings.LockDatePeriod)' style="width: 100px; display: inline-block;">
                            <option value="Days" @(Model.Settings.LockDatePeriod == "Days" ? " selected=true" : string.Empty)>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Days</option>
                            <option value="Weeks" @(Model.Settings.LockDatePeriod == "Weeks" ? " selected=true" : string.Empty)>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Weeks</option>
                            <option value="Months" @(Model.Settings.LockDatePeriod == "Months" ? " selected=true" : string.Empty)>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Months</option>
                        </select>
                    </div>
                    <div>
                        <input class="tt-bottom-right btn btn-primary" type="submit" value=@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Save />
                    </div>
                }
            </div>
        </div>
        <div class="panel panel-info" style="position: relative;">
            <div class="panel-heading">
                <h1 class="panel-title">@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Overtime</h1>
            </div>
            <div id="Overtime" class="panel-body">
                @using (Html.BeginForm(ActionConstants.UpdateOvertime, ControllerConstants.TimeEntry, FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                    @Html.AntiForgeryToken();

                    <div id="OTCheck" style="margin:10px">
                        @{    bool overTimeUsed = Model.Settings.OvertimeHours > 0;
                        }
                        <input type="radio" name="setting" id="setting" value="Yes" onclick="hideOT(false)" @(overTimeUsed ? " checked" : string.Empty) /><text> @AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Yes</text>
                        <input type="radio" name="setting" id="setting" value="No" onclick="hideOT(true)" @(!overTimeUsed ? " checked" : string.Empty) /><text> @AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.No</text>
                    </div>

                    <div id="OTSettings" style="visibility: @(overTimeUsed ? "visible" : "hidden")">
                        <div style="margin:10px">
                            @AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.After
                            <input type="text" id="hours" name="hours" value='@(Model.Settings.OvertimeHours < 0 ? 40 : Model.Settings.OvertimeHours)' class="form-control" style="width: 50px; text-align: right; display: inline-block;" /> @AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.HoursPer
                            <select id="period" name="period" class="form-control" value='@Model.Settings.OvertimePeriod' style="display: inline-block; width: 100px;">
                                <option value="Day" @(Model.Settings.OvertimePeriod == "Day" ? " selected=true" : string.Empty)>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Day</option>
                                <option value="Week" @(Model.Settings.OvertimePeriod == "Week" ? " selected=true" : string.Empty)>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Week</option>
                                <option value="Month" @(Model.Settings.OvertimePeriod == "Month" ? " selected=true" : string.Empty)>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Month</option>
                            </select><br />
                        </div>
                        <div style="margin:10px">
                            @AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.WithAMultiplierOf
                            <input type="text" id="mult" name="mult" value='@Model.Settings.OvertimeMultiplier.ToString("G10")' class="form-control" style="width: 60px; text-align: right; display: inline-block;" />
                        </div>
                    </div>
                    <div>
                        <input class="btn btn-primary tt-bottom-right" type="submit" value=@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Save />
                    </div>
                            }
            </div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">
                <h1 class="panel-title">@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Holidays</h1>
            </div>
            <div id="Holidays">

                <table class="table table-condensed">
                    <thead>
                        <tr>
                            <th>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Holiday</th>
                            <th>@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Date</th>
                            <th><span class="pull-right">Delete</span></th>
                        </tr>
                    </thead>
                    @foreach (Holiday Holiday in Model.Holidays)
                    {
                        <tr>
                            <td>
                                @(AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.ResourceManager.GetString(((Holiday.HolidayName).Replace(" ", string.Empty)).Replace("'", string.Empty)) ?? Holiday.HolidayName)
                            </td>
                            <td>
                                @Holiday.Date.ToShortDateString()
                            </td>
                            <td>
								<a href="javascript: void(0);" class="text-muted" title="Delete Holiday"
								   onclick='deleteHoliday("@Holiday.HolidayId", "@Holiday.HolidayName")'><span class="fa fa-fw fa-remove text-danger pull-right"></span></a>
                            </td>
                        </tr>
                    }
                    <tr>
                        @using (Html.BeginForm(ActionConstants.CreateHoliday, ControllerConstants.TimeEntry, FormMethod.Post))
                        {
                            @Html.AntiForgeryToken();
                            <td><input type="text" class="form-control" name="NewHolidayName" /></td>
                            <td><input type="date" class="form-control" name="NewHolidayDate" /></td>
                            <td><input class="pull-right btn btn-primary" type="submit" value=@AllyisApps.Resources.TimeTracker.Views.TimeEntry.Strings.Add /></td>
                        }
                    </tr>
                </table>
            </div>
        </div>
</div>

@section scripts{
	<script type="text/javascript">
		deletePayClassWarning = "Are you sure you want to delete the pay class {0}?";
		deletePayClassUrl = "@Url.Action(ActionConstants.DeletePayClass, ControllerConstants.TimeEntry, new { PayClassId = -1 })"
		deleteHolidayWarning = "Are you sure you want to delete the holiday {0}?";
		deleteHolidayUrl = "@Url.Action(ActionConstants.DeleteHoliday, ControllerConstants.TimeEntry, new { HolidayId = -1 })"
	</script>

	@Scripts.Render("~/bundles/TTTimeEntrySettings")
}
